pipeline {
    agent any

    stages {
        stage('Prepare Greeting') {
            steps {
                script {
                    // Define a string and store it in an environment variable
                    env.GREETING_MESSAGE = "Hello from Stage 1!"
                    echo "Stage 1 prepared message: ${env.GREETING_MESSAGE}"
                }
            }
        }
        stage('Display and Say Goodbye') {
            steps {
                script {
                    // Use the environment variable set in the previous stage
                    echo "${env.GREETING_MESSAGE}"
                    echo "Now, goodbye from Stage 2!"
                }
            }
        }
    }

    post {
        always {
            echo 'Pipeline finished.'
        }
    }
}
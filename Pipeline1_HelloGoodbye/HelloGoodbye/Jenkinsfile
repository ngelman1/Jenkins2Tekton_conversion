pipeline {
    agent any

    environment {
        GREETING_MESSAGE = ''
    }

    stages {
        stage('Stage 1 - Create Greeting') {
            steps {
                script {
                    GREETING_MESSAGE = 'hello from first stage'
                    echo "Stage 1 message: ${GREETING_MESSAGE}"
                }
            }
        }

        stage('Stage 2 - Append Message') {
            steps {
                script {
                    GREETING_MESSAGE += ' goodbye from task 2'
                    echo "Stage 2 updated message: ${GREETING_MESSAGE}"
                }
            }
        }

        stage('Final Stage - Print Message') {
            steps {
                echo "Final message: ${GREETING_MESSAGE}"
            }
        }
    }
}
